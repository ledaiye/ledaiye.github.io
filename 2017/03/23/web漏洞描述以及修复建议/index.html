<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="等我对自己很满意的时候，再预谋一场艳遇，岂不美哉。"><title>web漏洞描述以及修复建议 | 凉城Lc</title><link rel="stylesheet" type="text/css" href="//fonts.css.network/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.1"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.1"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">web漏洞描述以及修复建议</h1><a id="logo" href="/.">凉城Lc</a><p class="description">真正的不自由，是在自己的心中设下牢笼</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/categories/漏洞描述"><i class="fa fa-star"> 漏洞描述</i></a><a href="/安全导航/"><i class="fa fa-share"> 安全导航</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="Arama"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">web漏洞描述以及修复建议</h1><div class="post-meta"><a href="/2017/03/23/web漏洞描述以及修复建议/#comments" class="comment-count"></a><p><span class="date">Mar 23, 2017</span><span><a href="/categories/漏洞描述/" class="category">漏洞描述</a></span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>点击</i></i></span></p></div><div class="post-content"><p><code>相关</code></p>
<p><a href="http://wiki.open.qq.com/wiki/Web%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B%E5%8F%8A%E4%BF%AE%E5%A4%8D" target="_blank" rel="noopener">http://wiki.open.qq.com/wiki/Web%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B%E5%8F%8A%E4%BF%AE%E5%A4%8D</a></p>
<p><a href="https://book.thief.one/" target="_blank" rel="noopener">https://book.thief.one/</a></p>
<p><code>内容均来自互联网，风险等级根据实际情况定义</code></p>
<a id="more"></a>
<h2 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h2><p>风险等级:<font color="red" font-size="14px">高危</font></p>
<p>1.漏洞描述**</p>
<p>SQL注入攻击是黑客对数据库进行攻击的常用手段之一。</p>
<p>随着B/S模式应用开发的发展，使用这种模式编写应用程序的程序员也越来越多。但是由于程序员的水平及经验也参差不齐，相当大一部分程序员在编写代码的时候，没有对用户输入数据的合法性进行判断，导致Web程序代码中对于用户提交的参数未做过滤就直接放到SQL语句中执行，导致参数中的特殊字符打破了SQL语句原有逻辑，黑客可以利用该漏洞执行任意SQL语句。这就是SQL注入。</p>
<p><strong>2.解决建议</strong></p>
<p>1)使用参数化查询，对进入数据库中的语句进行转义处理，数据类型确定，编码统一，做好过滤防护工作，避免网站显示SQL错误信息。</p>
<p>2)部署Web应用防火墙；（设备层）</p>
<p>3)对数据库操作进行监控。（数据库层）</p>
<p><strong>3.漏洞危害：</strong></p>
<ol>
<li>机密数据被窃取；</li>
<li>核心业务数据被篡改；</li>
<li>网页被篡改；</li>
<li>数据库所在服务器被攻击从而变为傀儡主机，导致局域网(内网)被入侵。</li>
</ol>
<h2 id="xss跨站"><a href="#xss跨站" class="headerlink" title="xss跨站"></a>xss跨站</h2><p>风险等级:<font color="red" font-size="14px">高危</font></p>
<p><strong>1.漏洞描述</strong></p>
<p>跨站脚本攻击（也称为XSS）指利用网站漏洞从用户那里恶意盗取信息，恶意用户可以使用该漏洞来模拟其他用户身份登录，更甚至可以修改呈现给其他用户的内容。</p>
<p>用户在浏览网站、使用即时通讯软件、甚至在阅读电子邮件时，通常会点击其中的链接。攻击者通过在链接中插入恶意代码，就能够盗取用户信息或在终端用户系统上执行恶意代码。</p>
<p><strong>2.解决建议</strong></p>
<p>1)推荐措施包括实施安全编程技术确保正确过滤用户提供的数据，并编码所有用户提供的数据以防以可执行的格式向终端用户发送注入的脚本。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PHP: string htmlspecialchars (string string [,int quote_style])</span><br><span class="line">ASP/ASP.NET: Server.HTMLEncode (strHTML String)</span><br></pre></td></tr></table></figure>
<p>2)确保web应用对所有输入参数（cookies、头、查询字符串、表单、隐藏字段等）验证严格定义的预期结果。 </p>
<p>3)检查POST和GET请求的响应，确保返回内容是预期的且有效。</p>
<p>4)对所有输入输出做限制，避免出现如script，iframe等字样，不仅在客户端做验证与过滤，服务端更加需要验证和过滤，并且统一编码格式，做好转义处理。</p>
<h2 id="链接注入"><a href="#链接注入" class="headerlink" title="链接注入"></a>链接注入</h2><p>风险等级:<font color="red" font-size="14px">中危</font></p>
<p><strong>1.漏洞描述</strong></p>
<p>“链接注入”是修改站点内容的行为，其方式为将外部站点的URL嵌入其中，或将有易受攻击的站点中的脚本的URL嵌入其中。将URL嵌入易受攻击的站点中，攻击者便能够以它为平台来启动对其他站点的攻击，以及攻击这个易受攻击的站点本身。</p>
<p><strong>2.漏洞危害</strong></p>
<p>1)可能会引诱初级用户提供诸如用户名、密码、信用卡号、社会保险号等敏感信息</p>
<p>2)可能会窃取或操纵客户会话和cookie，可能用于模仿合法用户，从而使黑客能够以该用户身份查看或变更用户记录以及执行事务。</p>
<p>3)可能会在Web服务器上上载、修改或删除Web页面、脚本和文件。</p>
<p><strong>3.解决建议</strong></p>
<p>对用户输入内容进行过滤。</p>
<p>通过验证用户输入不能包含危险字符，防止恶意的用户执行应用程序执行计划外的任务，</p>
<p>例如：启动任意SQL查询、嵌入将在客户端执行的Javascript代码、运行各种操作系统命令，等等。</p>
<h2 id="LDAP注入漏洞"><a href="#LDAP注入漏洞" class="headerlink" title="LDAP注入漏洞"></a>LDAP注入漏洞</h2><p>风险等级:<font color="red" font-size="14px">高危</font></p>
<p><strong>1.漏洞描述：</strong></p>
<p>LDAP是一种轻量级目录访问协议，可以用来保存信息。如果在查询语句中插入恶意代码，可以修改返回的结果</p>
<p><strong>2.漏洞危害：</strong></p>
<p>1)机密数据被窃取；</p>
<p><strong>3.修复建议：</strong></p>
<p>1)在查询中对用户输入的数据进行严格过滤；</p>
<p>2)部署Web应用防火墙；</p>
<h2 id="命令执行漏洞"><a href="#命令执行漏洞" class="headerlink" title="命令执行漏洞"></a>命令执行漏洞</h2><p>风险等级:<font color="red" font-size="14px">高危</font></p>
<p><strong>1.漏洞描述：</strong></p>
<p>命令执行漏洞是指代码未对用户可控参数做过滤，导致直接带入执行命令的代码中，对恶意构造的语句，可被用来执行任意命令。</p>
<p><strong>2.漏洞危害：</strong></p>
<p>黑客可在服务器上执行任意命令，写入后门，从而入侵服务器，获取服务器的管理员权限，危害巨大。</p>
<p><strong>3.修复建议：</strong></p>
<p>严格过滤用户输入的数据，禁止执行系统命令</p>
<h2 id="短文件名泄漏漏洞"><a href="#短文件名泄漏漏洞" class="headerlink" title="短文件名泄漏漏洞"></a>短文件名泄漏漏洞</h2><p><strong>1.漏洞描述</strong></p>
<p>该漏洞由于Windows处理较长文件名时为方便使用较短的文件名代替，攻击者可利用该漏洞尝试获取网站服务器下的文件名。</p>
<p><strong>2.漏洞危害</strong></p>
<p>黑客可通过该漏洞尝试获取网站服务器下存放文件的文件名，达到获取更多信息来入侵服务器的目的。</p>
<p><strong>3.修复建议</strong></p>
<ul>
<li>修改Windows配置，关闭短文件名功能。</li>
<li>部署Web应用防火墙，防止攻击者批量尝试。</li>
</ul>
<h2 id="URL存在框架注入漏洞"><a href="#URL存在框架注入漏洞" class="headerlink" title="URL存在框架注入漏洞"></a>URL存在框架注入漏洞</h2><p>风险等级:<font color="red" font-size="14px">中危</font></p>
<p><strong>1.漏洞描述</strong></p>
<p>攻击者有可能注入含有恶意内容的 frame 或 iframe标记。</p>
<p>如果用户不够谨慎，就有可能浏览该标记，却意识不到自己会离开原始站点而进入恶意的站点。之后，攻击者便可以诱导用户再次登录，然后获取其登录凭证。</p>
<p>2.解决建议</p>
<p>建议过滤出所有以下字符： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[1] |（竖线符号）</span><br><span class="line"></span><br><span class="line">[2] &amp; （&amp; 符号）</span><br><span class="line"></span><br><span class="line">[3] ;（分号）</span><br><span class="line"></span><br><span class="line">[4] $（美元符号）</span><br><span class="line"></span><br><span class="line">[5] %（百分比符号）</span><br><span class="line"></span><br><span class="line">[6] @（at符号）</span><br><span class="line"></span><br><span class="line">[7] &apos;（单引号）</span><br><span class="line"></span><br><span class="line">[8] &quot;（引号）</span><br><span class="line"></span><br><span class="line">[9] \&apos;（反斜杠转义单引号）</span><br><span class="line"></span><br><span class="line">[10] \&quot;（反斜杠转义引号）</span><br><span class="line"></span><br><span class="line">[11] &lt;&gt;（尖括号）</span><br><span class="line"></span><br><span class="line">[12] ()（括号）</span><br><span class="line"></span><br><span class="line">[13] +（加号）</span><br><span class="line"></span><br><span class="line">[14] CR（回车符，ASCII 0x0d）</span><br><span class="line"></span><br><span class="line">[15] LF（换行，ASCII 0x0a）</span><br><span class="line"></span><br><span class="line">[16] ,（逗号）</span><br><span class="line"></span><br><span class="line">[17] \（反斜杠）</span><br></pre></td></tr></table></figure>
<h2 id="敏感信息泄露"><a href="#敏感信息泄露" class="headerlink" title="敏感信息泄露"></a>敏感信息泄露</h2><p>风险等级:<font color="red" font-size="14px">中危</font></p>
<p><strong>1.漏洞描述</strong></p>
<p>由于网站管理员缺乏足够的安全意识或者配置不当，造成一些敏感信息泄露，黑客可以通过这些信息进行下一步攻击。</p>
<p><strong>2.漏洞危害</strong></p>
<ol>
<li>攻击者可直接下载用户的相关信息，包括网站的绝对路径、用户的登录名、密码、真实姓名、身份证号、电话号码、邮箱、QQ号等；</li>
<li>攻击者通过构造特殊URL地址，触发系统web应用程序报错，在回显内容中，获取网站敏感信息；</li>
<li>攻击者利用泄漏的敏感信息，获取网站服务器web路径，为进一步攻击提供帮助；</li>
<li>robots文件暴露web站点结构，黑客可通过此信息进行下一步攻击；</li>
<li>管理入口地址暴露，黑客可通过此信息进行下一步攻击。</li>
</ol>
<p><strong>3.解决建议</strong></p>
<ol>
<li>对网站错误信息进行统一返回，模糊化处理；</li>
<li>对存放敏感信息的文件进行加密并妥善储存，避免泄漏敏感信息。</li>
</ol>
<h2 id="目录遍历"><a href="#目录遍历" class="headerlink" title="目录遍历"></a>目录遍历</h2><p>风险等级:<font color="red" font-size="14px">中危</font></p>
<p><strong>1.漏洞描述</strong></p>
<p>目录遍历漏洞是由于Web服务器设置不当导致的，攻击者可利用此漏洞查看Web目录下的文件及其文件夹，从而找到可攻击的文件。该漏洞一般被攻击者作为辅助攻击的手段之一。</p>
<p>由于网站管理员对服务器或CMS配置不当，导致目录可被遍历，黑客可以获知整个网站的结构。</p>
<p><strong>2.解决建议</strong></p>
<p>全面进行Web站点安全设置，防止攻击者能够仿冒成站点的其他用户来执行操作；确保Web站点对用户的安全分级授权方式越级和跨出合法区域的访问；对使用的Web应用系统进行升级和放漏洞补丁操作。</p>
<p>关闭WEB服务器目录浏览功能，对CMS进行安全配置或者对低版本的CMS进行补丁升级。</p>
<p>定期对相关管理人员和技术人员进行安全培训，提高安全技术能力和实际操作能力。</p>
<p>建立和完善一套有效的安全管理制度，对网站的日常维护和使用进行规范。</p>
<h2 id="弱口令"><a href="#弱口令" class="headerlink" title="弱口令"></a>弱口令</h2><p>风险等级:<font color="red" font-size="14px">中危</font></p>
<p>1.漏洞描述</p>
<p>弱密码即容易破译的密码，多为简单的数字组合、帐号相同的数字组合、键盘上的临近键或常见姓名、终端设备出厂配置的通用密码等都属于弱密码范畴。攻击者很容易预测用户名和密码，登录应用程序，从而获取未获授权的特权。</p>
<p>由于网站管理员缺乏足够的安全意识，使用了默认口令或较简单的口令，致使黑客可以轻易猜测到口令。</p>
<p>2.解决建议</p>
<p>加强口令密码管理制度，设置强口令，在大型信息系统和运维环境复杂的情况下，可以采用运维管理设备进行密码管理。</p>
<p>增加验证机制，防爆破机制，限制ip＋cookie访问次数。</p>
<p>建立和完善一套有效的安全管理制度，对网站的日常维护和使用进行规范。</p>
<h2 id="黑链"><a href="#黑链" class="headerlink" title="黑链"></a>黑链</h2><p>风险等级:<font color="red" font-size="14px">中危</font></p>
<p><strong>1.漏洞描述</strong></p>
<p>网站源代码中发现大量黑链，这表示网站受到入侵，黑客已经获取到一定权限。</p>
<p><strong>2.解决建议</strong></p>
<p>对源代码进行全面审查，删除黑链</p>
<h2 id="启用了TRACE"><a href="#启用了TRACE" class="headerlink" title="启用了TRACE"></a>启用了TRACE</h2><p>风险等级:<font color="red" font-size="14px">中危</font></p>
<p><strong>1.漏洞描述</strong></p>
<p>TRACE方法用于调用请求消息的远程应用层回送。</p>
<p>请求的最终接收方应该以 200（OK）响应的实体主体向客户端反映接收到的消息。</p>
<p>TRACE 可让客户端查看在请求链的另一端收到什么，并将这项数据用于测试或诊断信息。</p>
<p>TRACE方法是HTTP（超文本传输）协议定义的一种协议调试方法，该方法使得服务器原样返回任何客户端请求的内容。</p>
<p><strong>2.漏洞危害</strong>：</p>
<p>恶意攻击者可以通过TRACE方法返回的信息了解到网站前端的某些信息，如缓存服务器等，从而为进一步的攻击提供便利。</p>
<p><strong>3.解决建议</strong></p>
<p>a、2.0.55以上的Apache服务器，在httpd.conf的尾部添加：TraceEnable off。</p>
<p>b、如果使用的是Apache：</p>
<p>确认rewrite模块激活（httpd.conf，下面一行前面没有#):</p>
<p>LoadModule rewrite_module modules/mod_rewrite.so</p>
<p>在各虚拟主机的配置文件里添加如下语句：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RewriteEngine On</span><br><span class="line">RewriteCond %&#123;REQUEST_METHOD&#125; ^TRACE</span><br><span class="line">RewriteRule .* -[F]</span><br></pre></td></tr></table></figure></p>
<h2 id="慢速攻击"><a href="#慢速攻击" class="headerlink" title="慢速攻击"></a>慢速攻击</h2><p>风险等级:<font color="red" font-size="14px">中危</font></p>
<p><strong>1.漏洞描述</strong></p>
<p>针对任意HTTP Server，建立一个连接，以很低的速度发包，并保持住这个连接不断开。如果客户端持续建立这样的连接，那么服务器上可用的连接池将很快被占满，从而导致拒绝服务攻击。</p>
<p><strong>2.解决建议</strong></p>
<p>a、限制web服务器的HTTP头部传输的最大许可时间。</p>
<p>b、升级到最新版的apache。</p>
<p>c、限制web服务器的HTTP头部传输的最大许可时间，在apache中添加<code>mod_reqtimeout.so</code>模块，Apache2.2.15后，该模块已经被默认包含，在httpd.conf中添加 <code>LoadModule reqtimeout_module modules/mod_reqtimeout.so</code>，在<code>httpd.conf</code>中添加<code>RequestReadTimeout header=20-40,MinRate=500 body=20,MinRate=500</code>。重启apache服务，测试是否正常。</p>
<h2 id="host头部攻击"><a href="#host头部攻击" class="headerlink" title="host头部攻击"></a>host头部攻击</h2><p>风险等级:<font color="red" font-size="14px">中危</font></p>
<p><strong>1.漏洞描述</strong></p>
<p>为了方便的获得网站域名，开发人员一般依赖于HTTP Host header。例如，在php里用<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$_SERVER[<span class="string">"HTTP_HOST"</span>]。</span><br></pre></td></tr></table></figure></p>
<p>但是这个header是不可信赖的，如果应用程序没有对host header值进行处理，就有可能造成恶意代码的传入。</p>
<p><strong>2.解决建议</strong></p>
<p>web应用程序应该使用SERVER_NAME而不是host header。</p>
<p>在Apache和Nginx里可以通过设置一个虚拟机来记录所有的非法host header。</p>
<p>在Nginx里还可以通过指定一个SERVER_NAME名单，Apache也可以通过指定一个SERVER_NAME名单并开启UseCanonicalName选项。</p>
<h2 id="KindEditor3-5-5遍历目录漏洞"><a href="#KindEditor3-5-5遍历目录漏洞" class="headerlink" title="KindEditor3.5.5遍历目录漏洞"></a>KindEditor3.5.5遍历目录漏洞</h2><p>风险等级:<font color="red" font-size="14px">中危</font></p>
<p><strong>1.漏洞描述</strong></p>
<p>KindEditor是一套开源的HTML可视化编辑器，主要用于让用户在网站上获得所见即所得编辑效果，兼容IE、Firefox、Chrome、Safari、Opera等主流浏览器。KindEditor目录/php/file_manager_json.php，<br>存在遍历目录漏洞。</p>
<p><strong>2.解决建议</strong></p>
<p>目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载：</p>
<p><a href="http://www.kindsoft.Net/" target="_blank" rel="noopener">http://www.kindsoft.Net/</a></p>
<h2 id="cookie缺少HttpOnly属性"><a href="#cookie缺少HttpOnly属性" class="headerlink" title="cookie缺少HttpOnly属性"></a>cookie缺少HttpOnly属性</h2><p><strong>1.漏洞描述</strong></p>
<p>会话cookie中缺少HttpOnly属性会导致攻击者可以通过程序(JS脚本、Applet等)获取到用户的cookie信息，造成用户cookie信息泄露，增加攻击者的跨站脚本攻击威胁。</p>
<p>HttpOnly是微软对cookie做的扩展，该值指定cookie是否可通过客户端脚本访问。Microsoft Internet Explorer 版本 6 Service Pack 1和更高版本支持cookie属性HttpOnly。</p>
<p>如果在Cookie中没有设置HttpOnly属性为true，可能导致Cookie被窃取。窃取的Cookie可以包含标识站点用户的敏感信息，如ASP.NET会话ID或Forms身份验证票证，攻击者可以重播窃取的Cookie，以便伪装成用户或获取敏感信息，进行跨站脚本攻击等。</p>
<p>如果在Cookie中设置HttpOnly属性为true，兼容浏览器接收到HttpOnly cookie，那么客户端通过程序(JS脚本、Applet等)将无法读取到Cookie信息，这将有助于缓解跨站点脚本威胁</p>
<p><strong>2.解决建议</strong></p>
<p>向所有会话cookie中添加“HttpOnly”属性。 Php.ini session.cookie_httponly=</p>
<h2 id="存在永久性cookie"><a href="#存在永久性cookie" class="headerlink" title="存在永久性cookie"></a>存在永久性cookie</h2><p><strong>1.漏洞描述</strong></p>
<p>发现目标存在永久性Cookie。这可能使攻击者通过其他方式获得用户的会话凭证，这个时候，例如利用xss漏洞获得Cookie或者Session劫持就很有效了，具体分析应用程序的认证，然后使用某些技巧，甚至可以即使对方退出程序也一样永久性获得对方的身份，在未来很长时间甚至永久的控制账户。</p>
<p><strong>2.解决建议</strong></p>
<p>不要设置cookie为永久性的，修改cookie的属性expires的值，将cookie在会话关闭时则无效；或者一段时间内，过期后无效。</p>
<p>CI配置文件 application/config/config.php关于SESSION COOKIE的配置参数</p>
<h2 id="在源码中存在用户名和密码泄露"><a href="#在源码中存在用户名和密码泄露" class="headerlink" title="在源码中存在用户名和密码泄露"></a>在源码中存在用户名和密码泄露</h2><p>风险等级:<font color="red" font-size="14px">中危</font></p>
<p><strong>1.漏洞描述</strong></p>
<p>检测到目标站点的源码信息中可能存在用户名或者密码此类的敏感信息，从而可能造成用户或者站点的敏感信息泄露。如果用户名或者密码信息真实存在，那么攻击者便可以利用此信息，对目标站点进行进一步有效的攻击。由于该插件使用模式匹配方式检测，可能会出现误报，需要人工进行进一步核实。</p>
<p><strong>2.解决建议</strong></p>
<p>删除此类文件或限制此类文件的访问权限。</p>
<h2 id="错误页面web服务器版本泄露"><a href="#错误页面web服务器版本泄露" class="headerlink" title="错误页面web服务器版本泄露"></a>错误页面web服务器版本泄露</h2><p>风险等级:<font color="red" font-size="14px">中危</font></p>
<p><strong>1.漏洞描述</strong></p>
<p>Web服务器未能正确处理异常请求导致Web服务器版本信息泄露，攻击者收集到服务器信息后可进行进一步针对性攻击。</p>
<p><strong>2.解决建议</strong></p>
<p>临时修复建议如下：</p>
<p>1.关闭web服务器错误提示。</p>
<p>2.关闭运行平台的错误提示。</p>
<p>3.建立错误机制，不要把真实的错误反馈给访问者。</p>
<h2 id="目标网站存在上传下载相关的目录和文件"><a href="#目标网站存在上传下载相关的目录和文件" class="headerlink" title="目标网站存在上传下载相关的目录和文件"></a>目标网站存在上传下载相关的目录和文件</h2><p><strong>1.漏洞描述</strong></p>
<p>检测到目标网站存在上传下载相关的目录和文件。上传目录一般具有可写权限。攻击者可以预测文件上传的路径，便于和目标站点的其他漏洞攻击结合攻击目标服务器。</p>
<p><strong>2.解决建议</strong></p>
<p>检查此类目录的访问权限。如果不需要这些目录，建议删除。</p>
<h2 id="后台登录入口暴露"><a href="#后台登录入口暴露" class="headerlink" title="后台登录入口暴露"></a>后台登录入口暴露</h2><p>风险等级:<font color="red" font-size="14px">中危</font></p>
<p><strong>1.漏洞描述</strong></p>
<p>检查到目标应用的后台登陆入口。管理员应用程序一般用于网站的后台管理，具有全部的权限。这些应用程序可能包含一些敏感信息或具有较低的安全保护，攻击者可以通过该文件获取敏感信息或者进入网站后台，进行恶意操作。</p>
<p><strong>2.解决建议</strong></p>
<p>加强访问此类文件的认证和使用安全。<br>如果不需要此类文件，请删除。<br>修改为不可预测的文件名。<br>对管理地址进行更名，让管理地址变得不可猜测</p>
<h2 id="存在web默认目录"><a href="#存在web默认目录" class="headerlink" title="存在web默认目录"></a>存在web默认目录</h2><p>风险等级:<font color="red" font-size="14px">中危</font></p>
<p><strong>1.漏洞描述</strong></p>
<p>web应用架构中的目录都采用常见的目录名。如图片目录images,JavaScript目录js,不同的目录潜在的危险是不同的。攻击者一般利用常见目录中可能包含的敏感文件获取敏感信息。</p>
<p><strong>2.解决建议</strong></p>
<p>如果不需要这些目录，可以删除此类目录；<br>或者严格限制目录的访问权限。</p>
<h2 id="form表单验证码点击不变"><a href="#form表单验证码点击不变" class="headerlink" title="form表单验证码点击不变"></a>form表单验证码点击不变</h2><p>风险等级:<font color="red" font-size="14px">中危</font></p>
<p><strong>1.漏洞描述</strong></p>
<p>在form表单中，验证码出现第一次之后，点击验证码图片，验证码不会变，只有在刷新页面的时候，验证码才会改变，这会导致攻击者可以绕开验证码，而对表单进行爆破。</p>
<p><strong>2.解决建议</strong></p>
<p>加强验证码验证模块</p>
<h2 id="危险的HTTP请求类型"><a href="#危险的HTTP请求类型" class="headerlink" title="危险的HTTP请求类型"></a>危险的HTTP请求类型</h2><p>风险等级:<font color="red" font-size="14px">中危</font></p>
<p><strong>1.漏洞描述</strong></p>
<p>web服务器或应用服务器是以不安全的方式配置的，会在web服务器上上传、修改或删除web页面、脚本和文件。</p>
<p><strong>2.解决建议</strong></p>
<p>如果服务器不需要支持 WebDAV，请务必禁用它，或禁止如下不必要的 HTTP 方法。</p>
<h2 id="逻辑设计缺陷"><a href="#逻辑设计缺陷" class="headerlink" title="逻辑设计缺陷"></a>逻辑设计缺陷</h2><p>1.漏洞描述</p>
<p>逻辑设计缺陷是因为产品在最初设计时由于未考虑全面，而使产品在使用中存在的一些潜在的缺陷。</p>
<p>2.解决建议</p>
<p>在输入接口设置验证，如token，验证码等。注册界面的接口不要返回太多敏感信息，以防遭到黑客制作枚举字典。验证码请不要以短数字来甚至，最好是以字母加数字进行组合，并且验证码需要设定时间期限。</p>
<p><a href="https://zhuanlan.zhihu.com/p/19728040" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/19728040</a><br><a href="http://www.freebuf.com/vuls/112339.html" target="_blank" rel="noopener">http://www.freebuf.com/vuls/112339.html</a></p>
<h2 id="后门"><a href="#后门" class="headerlink" title="后门"></a>后门</h2><p><strong>1.漏洞描述</strong></p>
<p>目标网站已经被黑客入侵，拿下webshell并留下后门。</p>
<p><strong>2.解决建议</strong></p>
<p>管理员定期手工或用专业的webshell扫描工具全面清查服务器中的文件，删除webshell。</p>
<h2 id="任意文件读取"><a href="#任意文件读取" class="headerlink" title="任意文件读取"></a>任意文件读取</h2><p>风险等级:<font color="red" font-size="14px">中危</font></p>
<p><strong>1.漏洞描述</strong></p>
<p>由于CMS编写时参数过滤不严，黑客可以用../的方式访问其他目录中的文件。</p>
<p><strong>2.解决建议</strong></p>
<p>严格检查变量是否已经初始化;在服务器本地文件及远程文件，进行严格的检查，参数中不允许出现../之类的目录跳转符。</p>
<h2 id="未授权访问"><a href="#未授权访问" class="headerlink" title="未授权访问"></a>未授权访问</h2><p><strong>1.漏洞描述</strong></p>
<p>由于CMS编写时采用本地验证机制或在服务器端验证不严，黑客可以采取绕过的方式对一些敏感信息或文件进行访问或操作。</p>
<p><strong>2.解决建议</strong></p>
<p>将对应的应用系统进行升级。</p>
<p>加强网站的验证机制与过滤机制，防止用户绕过过滤机制对一些敏感信息或危险功能进行访问和操作。</p>
<h2 id="上传漏洞"><a href="#上传漏洞" class="headerlink" title="上传漏洞"></a>上传漏洞</h2><p><strong>1.漏洞描述</strong></p>
<p>由于网站管理员的配置不当或者CMS的编写时未对上传的文件进行检查过滤或者过滤不严，致使黑客可以上传木马拿到webshell。</p>
<p><strong>2.解决建议</strong></p>
<p>客户端和服务端检测文件大小，文件后缀和文件内容等，并严格控制上传目录，不向用户暴露出具体路径。</p>
<h2 id="错误详情泄漏漏洞"><a href="#错误详情泄漏漏洞" class="headerlink" title="错误详情泄漏漏洞"></a>错误详情泄漏漏洞</h2><p><strong>1.漏洞描述</strong></p>
<p>页面含有CGI处理错误的代码级别的详细信息，例如sql语句执行错误原因，php的错误行数等。</p>
<p><strong>2.检测方法</strong></p>
<p>修改参数为非法参数，看页面返回的错误信息是否泄漏了过于详细的代码级别的信息。</p>
<p><strong>3.修复方案</strong></p>
<p>将错误信息对用户透明化，在CGI处理错误后可以返回友好的提示语以及返回码。但是不可以提示用户出错的代码级别的详细原因。</p>
</div><div class="tags"><a href="/tags/漏洞描述-解决建议/">漏洞描述 解决建议</a></div><div class="post-share"><div class="bdsharebuttonbox"><span style="float:left;line-height: 28px;height: 28px;font-size:16px;font-weight:blod">分享到：</span><a href="#" data-cmd="more" class="bds_more"></a><a href="#" data-cmd="mshare" title="分享到一键分享" class="bds_mshare"></a><a href="#" data-cmd="fbook" title="分享到Facebook" class="bds_fbook"></a><a href="#" data-cmd="twi" title="分享到Twitter" class="bds_twi"></a><a href="#" data-cmd="linkedin" title="分享到linkedin" class="bds_linkedin"></a><a href="#" data-cmd="youdao" title="分享到有道云笔记" class="bds_youdao"></a><a href="#" data-cmd="evernotecn" title="分享到印象笔记" class="bds_evernotecn"></a><a href="#" data-cmd="weixin" title="分享到微信" class="bds_weixin"></a><a href="#" data-cmd="qzone" title="分享到QQ空间" class="bds_qzone"></a><a href="#" data-cmd="tsina" title="分享到新浪微博" class="bds_tsina"></a></div></div><div class="post-nav"><a href="/2017/04/01/nmap基本使用总结/" class="pre">nmap基本使用总结</a><a href="/2017/03/02/应急响应总结/" class="next">应急响应总结</a></div><div id="comments"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#sql注入"><span class="toc-text">sql注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xss跨站"><span class="toc-text">xss跨站</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#链接注入"><span class="toc-text">链接注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LDAP注入漏洞"><span class="toc-text">LDAP注入漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#命令执行漏洞"><span class="toc-text">命令执行漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#短文件名泄漏漏洞"><span class="toc-text">短文件名泄漏漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#URL存在框架注入漏洞"><span class="toc-text">URL存在框架注入漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#敏感信息泄露"><span class="toc-text">敏感信息泄露</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#目录遍历"><span class="toc-text">目录遍历</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#弱口令"><span class="toc-text">弱口令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#黑链"><span class="toc-text">黑链</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#启用了TRACE"><span class="toc-text">启用了TRACE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#慢速攻击"><span class="toc-text">慢速攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#host头部攻击"><span class="toc-text">host头部攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#KindEditor3-5-5遍历目录漏洞"><span class="toc-text">KindEditor3.5.5遍历目录漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cookie缺少HttpOnly属性"><span class="toc-text">cookie缺少HttpOnly属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#存在永久性cookie"><span class="toc-text">存在永久性cookie</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#在源码中存在用户名和密码泄露"><span class="toc-text">在源码中存在用户名和密码泄露</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#错误页面web服务器版本泄露"><span class="toc-text">错误页面web服务器版本泄露</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#目标网站存在上传下载相关的目录和文件"><span class="toc-text">目标网站存在上传下载相关的目录和文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#后台登录入口暴露"><span class="toc-text">后台登录入口暴露</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#存在web默认目录"><span class="toc-text">存在web默认目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#form表单验证码点击不变"><span class="toc-text">form表单验证码点击不变</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#危险的HTTP请求类型"><span class="toc-text">危险的HTTP请求类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#逻辑设计缺陷"><span class="toc-text">逻辑设计缺陷</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#后门"><span class="toc-text">后门</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#任意文件读取"><span class="toc-text">任意文件读取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#未授权访问"><span class="toc-text">未授权访问</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#上传漏洞"><span class="toc-text">上传漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#错误详情泄漏漏洞"><span class="toc-text">错误详情泄漏漏洞</span></a></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/07/14/linux就该这么学-3/">linux就该这么学-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/13/linux就该这么学-2/">linux就该这么学-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/12/linux就该这么学-1/">linux就该这么学-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/10/突然间失落/">突然间失落</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/09/hello-world/">Hello World</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/13/黑客与画家-三-不能说的话/">黑客与画家-三-不能说的话</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/20/linux取证分析/">linux取证分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/01/记一次某医院勒索软件事件处理整理/">记一次某医院勒索软件事件处理整理</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/06/生活归于平静，学习才能静下心/">生活归于平静，学习才能静下心</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/30/从linux服务器的日志文件中提取有用信息/">从linux服务器的日志文件中提取有用信息</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/书籍分享/">书籍分享</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/学习/">学习</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/渗透/">渗透</a><span class="category-list-count">17</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/漏洞描述/">漏洞描述</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/阅读/">阅读</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/随笔/">随笔</a><span class="category-list-count">3</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/web后门/" style="font-size: 15px;">web后门</a> <a href="/tags/burp-suite/" style="font-size: 15px;">burp suite</a> <a href="/tags/crondtab/" style="font-size: 15px;">crondtab</a> <a href="/tags/nmap/" style="font-size: 15px;">nmap</a> <a href="/tags/sqlmap/" style="font-size: 15px;">sqlmap</a> <a href="/tags/渗透/" style="font-size: 15px;">渗透</a> <a href="/tags/web信息收集/" style="font-size: 15px;">web信息收集</a> <a href="/tags/crond-crondtab/" style="font-size: 15px;">crond,crondtab</a> <a href="/tags/web安全/" style="font-size: 15px;">web安全</a> <a href="/tags/书籍/" style="font-size: 15px;">书籍</a> <a href="/tags/漏洞描述-解决建议/" style="font-size: 15px;">漏洞描述 解决建议</a> <a href="/tags/移动应用/" style="font-size: 15px;">移动应用</a> <a href="/tags/系统漏洞/" style="font-size: 15px;">系统漏洞</a> <a href="/tags/勒索软件/" style="font-size: 15px;">勒索软件</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="http://www.ggsec.cn/" title="ggsec" target="_blank">ggsec</a><ul></ul><a href="http://www.secice.cn/" title="iceH_Blog" target="_blank">iceH_Blog</a><ul></ul><a href="http://www.errorsec.top/" title="errorsec" target="_blank">errorsec</a><ul></ul><a href="http://www.doubleyi.xin/" title="DOUBLE翊" target="_blank">DOUBLE翊</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">Baidu Site Haritası</a> |  <a href="/atom.xml">订阅</a> |  <a href="/about/">关于</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次</p><p><span> Copyright &copy;<a href="/." rel="nofollow">凉城Lc.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.1"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.1" async></script><script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","weixin","tsina","qzone","linkedin","fbook","twi","print","renren","sqq","evernotecn","bdysc","tqq","tqf","bdxc","kaixin001","tieba","douban","bdhome","thx","ibaidu","meilishuo","mogujie","diandian","huaban","duitang","hx","fx","youdao","sdo","qingbiji","people","xinhua","mail","isohu","yaolan","wealink","ty","iguba","h163","copy"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":{},"image":{"viewList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"]}};with(document)0[(getElementsByTagName('head')[0]||head).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script></body></html>